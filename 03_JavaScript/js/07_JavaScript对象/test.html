<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>

  <body>
    输入账号: <input type="text" />
    <p class="tip">请输入账号</p>

    <script>
      function isObject(value) {
        const valueType = typeof value;
        return (
          value != null && (valueType === "object" || valueType === "function")
        );
      }
      function deepCopy(originValue) {
        if (typeof originValue === "symbol") {
          return Symbol(originValue.description);
        }

        // 1.如果是原始类型, 直接返回
        if (!isObject(originValue)) return originValue;

        if (originValue instanceof Set) {
          const newSet = new Set();
          for (const setItem of originValue) {
            newSet.add(setItem);
          }
          return newSet;
        }

        // 2.如果是对象类型, 才需要创建对象
        const newObj = Array.isArray(originValue) ? [] : {};
        // 遍历普通的key
        for (const key in originValue) {
          newObj[key] = deepCopy(originValue[key]);
        }
        const symbolKeys = Object.getOwnPropertySymbols(originValue);
        for (const symbolKey of symbolKeys) {
          newObj[symbolKey.description] = deepCopy(originValue[symbolKey]);
        }
        return newObj;
      }
      const set = new Set(["abc", "cba", "nba"]);
      const info = {
        name: "why",
        age: 18,
        friend: {
          name: "kobe",
          address: {
            name: "洛杉矶",
            detail: "斯坦普斯中心",
          },
        },
        set: set,
      };

      const newObj = deepCopy(info);
      info.friend.address.name = "北京市";
      console.log(newObj);
      console.log(newObj.friend.address.name);

      const books = [
        {
          name: "黄金时代",
          price: 28,
          desc: { intro: "这本书不错", info: "这本书讲了一个很有意思的故事" },
        },
        { name: "你不知道JavaScript", price: 99 },
      ];

      const newBooks = deepCopy(books);
      books[0] = "1";
      console.log(newBooks);
    </script>
  </body>
</html>
